2025-11-15 03:22:24,910 - __main__ - INFO - Starting keyframe extraction system in supervision mode
2025-11-15 03:22:24,910 - __main__ - INFO - Using device: cuda:0
2025-11-15 03:22:24,910 - __main__ - INFO - Cache directory: .cache
2025-11-15 03:22:24,910 - __main__ - INFO - ============================================================
2025-11-15 03:22:24,910 - __main__ - INFO - STEP 1: GENERATING TEACHER SUPERVISION
2025-11-15 03:22:24,910 - __main__ - INFO - ============================================================
2025-11-15 03:22:24,910 - __main__ - INFO - Starting teacher supervision generation...
2025-11-15 03:22:24,910 - keyframe_extraction.teacher_model - INFO - Loading teacher model from /data/share/qwen/Qwen2.5-VL-7B-Instruct
2025-11-15 03:22:32,022 - keyframe_extraction.teacher_model - INFO - Teacher model loaded successfully
2025-11-15 03:22:32,192 - keyframe_extraction.frame_scoring - INFO - Loaded 31527 samples from beauty domain
2025-11-15 03:22:32,192 - keyframe_extraction.frame_scoring - INFO - Limited to 5 samples for prototyping
2025-11-15 03:22:32,370 - keyframe_extraction.frame_scoring - INFO - Loaded 32824 samples from sports domain
2025-11-15 03:22:32,371 - keyframe_extraction.frame_scoring - INFO - Limited to 5 samples for prototyping
2025-11-15 03:22:32,375 - keyframe_extraction.frame_scoring - INFO - Loaded total 9 videos from 2 domains
2025-11-15 03:22:32,379 - __main__ - INFO - Loaded 9 videos for supervision generation
2025-11-15 03:22:32,380 - keyframe_extraction.frame_scoring - INFO - Computing frame importance scores for https://m.media-amazon.com/images/S/vse-vms-transcoding-artifact-us-east-1-prod/v2/ab1b0dd9-52c7-5cc0-a58e-c1852fe65ff8/ShortForm-Generic-480p-16-9-1409173089793-rpcbe5.mp4
2025-11-15 03:22:37,529 - keyframe_extraction.video_loader - INFO - Video downloaded to .cache/e52eefb00f14590472678d1d6d524faf.mp4
2025-11-15 03:22:39,104 - keyframe_extraction.video_loader - INFO - Extracted 64 frames from .cache/e52eefb00f14590472678d1d6d524faf.mp4
2025-11-15 03:22:39,705 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp3j8id3l3.mp4', total_frames=16, video_fps=2.0, time=0.082s
2025-11-15 03:22:42,770 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 32.86 GiB is allocated by PyTorch, and 247.22 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:42,913 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp9nxtbpgz.mp4', total_frames=17, video_fps=2.0, time=0.045s
2025-11-15 03:22:43,437 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:43,568 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpys0d3c9j.mp4', total_frames=16, video_fps=2.0, time=0.051s
2025-11-15 03:22:44,062 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:44,172 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpu7giu3bn.mp4', total_frames=17, video_fps=2.0, time=0.030s
2025-11-15 03:22:44,665 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:44,774 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpiw2cihzy.mp4', total_frames=16, video_fps=2.0, time=0.036s
2025-11-15 03:22:45,253 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:45,364 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp95lwud6o.mp4', total_frames=17, video_fps=2.0, time=0.034s
2025-11-15 03:22:45,830 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:45,958 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpsqu_gzn0.mp4', total_frames=16, video_fps=2.0, time=0.044s
2025-11-15 03:22:46,491 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:46,615 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpy2e1o5pk.mp4', total_frames=17, video_fps=2.0, time=0.043s
2025-11-15 03:22:47,093 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:47,218 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpf6f_ir2y.mp4', total_frames=16, video_fps=2.0, time=0.042s
2025-11-15 03:22:47,721 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:47,853 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp7r_5woxz.mp4', total_frames=17, video_fps=2.0, time=0.051s
2025-11-15 03:22:48,299 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:48,413 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpwc4zf83t.mp4', total_frames=16, video_fps=2.0, time=0.038s
2025-11-15 03:22:48,892 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:49,007 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpg7264lna.mp4', total_frames=17, video_fps=2.0, time=0.033s
2025-11-15 03:22:49,500 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:49,609 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp4vi05am0.mp4', total_frames=16, video_fps=2.0, time=0.034s
2025-11-15 03:22:50,110 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:50,219 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpqz1ti1tm.mp4', total_frames=17, video_fps=2.0, time=0.031s
2025-11-15 03:22:50,765 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:50,881 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp4cbvkxm3.mp4', total_frames=16, video_fps=2.0, time=0.030s
2025-11-15 03:22:51,354 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:51,473 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpko8ibdmt.mp4', total_frames=17, video_fps=2.0, time=0.033s
2025-11-15 03:22:51,929 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:52,031 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpzlv28mzd.mp4', total_frames=16, video_fps=2.0, time=0.026s
2025-11-15 03:22:52,485 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:52,603 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp4q975h9y.mp4', total_frames=17, video_fps=2.0, time=0.036s
2025-11-15 03:22:53,079 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:53,200 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpk5c2xgxw.mp4', total_frames=16, video_fps=2.0, time=0.043s
2025-11-15 03:22:53,718 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:53,844 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpnxe9ds12.mp4', total_frames=17, video_fps=2.0, time=0.041s
2025-11-15 03:22:54,974 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:55,257 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpe1fq2vyu.mp4', total_frames=16, video_fps=2.0, time=0.201s
2025-11-15 03:22:55,706 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:55,837 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmphpfsvyvh.mp4', total_frames=17, video_fps=2.0, time=0.041s
2025-11-15 03:22:56,298 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:56,415 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpoe873z_m.mp4', total_frames=16, video_fps=2.0, time=0.041s
2025-11-15 03:22:56,867 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:56,986 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp4pcerv9g.mp4', total_frames=17, video_fps=2.0, time=0.038s
2025-11-15 03:22:57,489 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:57,604 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpscgalbkv.mp4', total_frames=16, video_fps=2.0, time=0.036s
2025-11-15 03:22:58,079 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:58,199 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpt_ow0lag.mp4', total_frames=17, video_fps=2.0, time=0.033s
2025-11-15 03:22:58,681 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:58,799 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpjaqe2q1z.mp4', total_frames=16, video_fps=2.0, time=0.034s
2025-11-15 03:22:59,269 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:59,381 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmptx8zwxw_.mp4', total_frames=17, video_fps=2.0, time=0.033s
2025-11-15 03:22:59,848 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:22:59,980 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpoipx4ujz.mp4', total_frames=16, video_fps=2.0, time=0.031s
