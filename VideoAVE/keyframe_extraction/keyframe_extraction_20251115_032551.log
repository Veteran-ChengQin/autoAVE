2025-11-15 03:25:51,608 - __main__ - INFO - Starting keyframe extraction system in supervision mode
2025-11-15 03:25:51,608 - __main__ - INFO - Using device: cuda:0
2025-11-15 03:25:51,609 - __main__ - INFO - Cache directory: .cache
2025-11-15 03:25:51,609 - __main__ - INFO - ============================================================
2025-11-15 03:25:51,609 - __main__ - INFO - STEP 1: GENERATING TEACHER SUPERVISION
2025-11-15 03:25:51,609 - __main__ - INFO - ============================================================
2025-11-15 03:25:51,609 - __main__ - INFO - Starting teacher supervision generation...
2025-11-15 03:25:51,609 - keyframe_extraction.teacher_model - INFO - Loading teacher model from /data/share/qwen/Qwen2.5-VL-7B-Instruct
2025-11-15 03:26:00,026 - keyframe_extraction.teacher_model - INFO - Teacher model loaded successfully
2025-11-15 03:26:00,202 - keyframe_extraction.frame_scoring - INFO - Loaded 31527 samples from beauty domain
2025-11-15 03:26:00,203 - keyframe_extraction.frame_scoring - INFO - Limited to 5 samples for prototyping
2025-11-15 03:26:00,379 - keyframe_extraction.frame_scoring - INFO - Loaded 32824 samples from sports domain
2025-11-15 03:26:00,379 - keyframe_extraction.frame_scoring - INFO - Limited to 5 samples for prototyping
2025-11-15 03:26:00,383 - keyframe_extraction.frame_scoring - INFO - Loaded total 9 videos from 2 domains
2025-11-15 03:26:00,387 - __main__ - INFO - Loaded 9 videos for supervision generation
2025-11-15 03:26:00,388 - keyframe_extraction.frame_scoring - INFO - Computing frame importance scores for https://m.media-amazon.com/images/S/vse-vms-transcoding-artifact-us-east-1-prod/v2/ab1b0dd9-52c7-5cc0-a58e-c1852fe65ff8/ShortForm-Generic-480p-16-9-1409173089793-rpcbe5.mp4
2025-11-15 03:26:01,265 - keyframe_extraction.video_loader - INFO - Extracted 48 frames from .cache/e52eefb00f14590472678d1d6d524faf.mp4
2025-11-15 03:26:01,629 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp3qqplw10.mp4', total_frames=16, video_fps=2.0, time=0.061s
2025-11-15 03:26:10,389 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 32.86 GiB is allocated by PyTorch, and 247.22 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:10,525 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmps9s90azk.mp4', total_frames=17, video_fps=2.0, time=0.041s
2025-11-15 03:26:11,148 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:11,273 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpo_jv1p4q.mp4', total_frames=16, video_fps=2.0, time=0.041s
2025-11-15 03:26:11,735 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:11,855 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp7r5lvm82.mp4', total_frames=17, video_fps=2.0, time=0.039s
2025-11-15 03:26:12,311 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:12,430 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpm9qmirk4.mp4', total_frames=16, video_fps=2.0, time=0.040s
2025-11-15 03:26:12,924 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:13,036 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpycdr1hyu.mp4', total_frames=17, video_fps=2.0, time=0.031s
2025-11-15 03:26:13,490 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:13,606 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpzzi5zb5e.mp4', total_frames=16, video_fps=2.0, time=0.041s
2025-11-15 03:26:14,071 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:14,192 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp6x6ytp6s.mp4', total_frames=17, video_fps=2.0, time=0.041s
2025-11-15 03:26:14,656 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:14,774 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpr3em5bhl.mp4', total_frames=16, video_fps=2.0, time=0.031s
2025-11-15 03:26:15,995 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:16,108 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpt1jvvsnt.mp4', total_frames=17, video_fps=2.0, time=0.027s
2025-11-15 03:26:16,577 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:16,704 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpdrzxc6z7.mp4', total_frames=16, video_fps=2.0, time=0.050s
2025-11-15 03:26:17,153 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:17,278 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpxqaw9x6o.mp4', total_frames=17, video_fps=2.0, time=0.045s
2025-11-15 03:26:17,740 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:17,856 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp6v0ajvve.mp4', total_frames=16, video_fps=2.0, time=0.040s
2025-11-15 03:26:18,291 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:18,430 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpe9go4t8h.mp4', total_frames=17, video_fps=2.0, time=0.057s
2025-11-15 03:26:18,879 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:18,981 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmpf9j7e5h2.mp4', total_frames=16, video_fps=2.0, time=0.027s
2025-11-15 03:26:19,445 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:19,568 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp4xwkgpxe.mp4', total_frames=17, video_fps=2.0, time=0.045s
2025-11-15 03:26:20,052 - keyframe_extraction.teacher_model - ERROR - Inference error: CUDA out of memory. Tried to allocate 15.88 GiB. GPU 0 has a total capacity of 47.37 GiB of which 13.53 GiB is free. Process 3562413 has 336.00 MiB memory in use. Including non-PyTorch memory, this process has 33.50 GiB memory in use. Of the allocated memory 17.06 GiB is allocated by PyTorch, and 16.04 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
2025-11-15 03:26:20,168 - qwen_vl_utils.vision_process - INFO - decord:  video_path='/tmp/tmp9xr8wluy.mp4', total_frames=16, video_fps=2.0, time=0.044s
